
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2. Functional Causal Graphical Models &#8212; pywhy-graphs v0.2.0.dev0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=130a53a1"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=fd10adb8"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/functional/index';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/neurodata/treeple/main/doc/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../../_static/favicon_url.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.2.1.1. pywhy_graphs.functional.discrete.make_random_discrete_graph" href="../../generated/pywhy_graphs.functional.discrete.make_random_discrete_graph.html" />
    <link rel="prev" title="1. Causal Graphs in PyWhy" href="../classes/index.html" />
    <link rel="canonical" href="https://py-why.github.io/pywhy-graphs/stable/index.html" />
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <script type="text/javascript" src="../../_static/scrollfix.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">pywhy-graphs v0.2.0.dev0</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api.html">
    Reference API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../use.html">
    Usage (Simple Examples)
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../whats_new.html">
    Release History
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/py-why/pywhy-graphs" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api.html">
    Reference API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../use.html">
    Usage (Simple Examples)
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../whats_new.html">
    Release History
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/py-why/pywhy-graphs" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../classes/index.html">1. Causal Graphs in PyWhy</a></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">2. Functional Causal Graphical Models</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.functional.discrete.make_random_discrete_graph.html">2.2.1.1. pywhy_graphs.functional.discrete.make_random_discrete_graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.functional.discrete.add_cpd_for_node.html">2.2.1.2. pywhy_graphs.functional.discrete.add_cpd_for_node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.functional.make_graph_linear_gaussian.html">2.5.1. pywhy_graphs.functional.make_graph_linear_gaussian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.functional.apply_linear_soft_intervention.html">2.5.2. pywhy_graphs.functional.apply_linear_soft_intervention</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.functional.make_graph_multidomain.html">2.7.1. pywhy_graphs.functional.make_graph_multidomain</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../algorithms/index.html">3. Causal Graph Algorithms in PyWhy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.is_valid_mec_graph.html">3.1.1. pywhy_graphs.algorithms.is_valid_mec_graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.possible_ancestors.html">3.1.2. pywhy_graphs.algorithms.possible_ancestors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.possible_descendants.html">3.1.3. pywhy_graphs.algorithms.possible_descendants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.discriminating_path.html">3.1.4. pywhy_graphs.algorithms.discriminating_path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.is_definite_noncollider.html">3.1.5. pywhy_graphs.algorithms.is_definite_noncollider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.valid_pag.html">3.1.6. pywhy_graphs.algorithms.valid_pag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.mag_to_pag.html">3.1.7. pywhy_graphs.algorithms.mag_to_pag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.pag_to_mag.html">3.1.8. pywhy_graphs.algorithms.pag_to_mag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.check_pag_definition.html">3.1.9. pywhy_graphs.algorithms.check_pag_definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.networkx.bidirected_to_unobserved_confounder.html">3.1.10. pywhy_graphs.networkx.bidirected_to_unobserved_confounder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.networkx.m_separated.html">3.1.11. pywhy_graphs.networkx.m_separated</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.networkx.is_minimal_m_separator.html">3.1.12. pywhy_graphs.networkx.is_minimal_m_separator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.networkx.minimal_m_separator.html">3.1.13. pywhy_graphs.networkx.minimal_m_separator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.pds.html">3.2.1. pywhy_graphs.algorithms.pds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.pds_path.html">3.2.2. pywhy_graphs.algorithms.pds_path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.uncovered_pd_path.html">3.2.3. pywhy_graphs.algorithms.uncovered_pd_path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.pds_t.html">3.3.1. pywhy_graphs.algorithms.pds_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.pds_t_path.html">3.3.2. pywhy_graphs.algorithms.pds_t_path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.algorithms.acyclification.html">3.4.1. pywhy_graphs.algorithms.acyclification</a></li>
</ul>
</details></li>

<li class="toctree-l1 has-children"><a class="reference internal" href="../simulation/index.html">5. Simulation module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.simulate.simulate_linear_var_process.html">5.1.1. pywhy_graphs.simulate.simulate_linear_var_process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.simulate.simulate_data_from_var.html">5.1.2. pywhy_graphs.simulate.simulate_data_from_var</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.simulate.simulate_var_process_from_summary_graph.html">5.1.3. pywhy_graphs.simulate.simulate_var_process_from_summary_graph</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../export/index.html">6. Importing causal graphs to PyWhy-Graphs, or exporting PyWhy-Graphs to another package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.export.graph_to_clearn.html">6.1.1. pywhy_graphs.export.graph_to_clearn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.export.clearn_to_graph.html">6.1.2. pywhy_graphs.export.clearn_to_graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.export.graph_to_numpy.html">6.2.1. pywhy_graphs.export.graph_to_numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.export.numpy_to_graph.html">6.2.2. pywhy_graphs.export.numpy_to_graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.export.graph_to_pcalg.html">6.3.1. pywhy_graphs.export.graph_to_pcalg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.export.pcalg_to_graph.html">6.3.2. pywhy_graphs.export.pcalg_to_graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.export.graph_to_tetrad.html">6.4.1. pywhy_graphs.export.graph_to_tetrad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/pywhy_graphs.export.tetrad_to_graph.html">6.4.2. pywhy_graphs.export.tetrad_to_graph</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">7. Glossary of Common Terms and API Elements</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../user_guide.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-pywhy_graphs.functional">
<span id="id1"></span><span id="functional-causal-graphical-models"></span><h1><span class="section-number">2. </span>Functional Causal Graphical Models<a class="headerlink" href="#module-pywhy_graphs.functional" title="Link to this heading">#</a></h1>
<p>Pywhy-graphs provides a layer to convert imbue causal graphs with a data-generating
model. Currently, we only support linear models, but we plan to support non-linear
and we also do not support latent confounders yet.</p>
<p>To add a latent confounder, one can add a confounder explicitly, generate the data
and then drop the confounder variable in the final dataset. In the roadmap of this submodule,
the plan is to represent any bidirected edge as a uniformly randomly distributed variable
that has an additive noise effect on both variables simultaneously.</p>
<p>Each functional graph has a string assigned to the <code class="docutils literal notranslate"><span class="pre">G.graph['functional']</span></code> networkX attribute,
which informs the user of which type of functional graph is being used. Currently, we support
the following types of functional graphs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'linear_gaussian'</span></code>: The graph is a linear-Gaussin functional graph.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'discrete'</span></code>: The graph is a discrete functional graph.</p></li>
</ul>
<section id="representing-a-node-s-functional-relationships">
<h2><span class="section-number">2.1. </span>Representing a node’s functional relationships<a class="headerlink" href="#representing-a-node-s-functional-relationships" title="Link to this heading">#</a></h2>
<p>Within an acyclic causal diagram, each node has a set of observed parents and an exogenous parent variable.
The exogenous parent variable is the variable that is not a child of any other node in the graph and
implicitly represents all exogenous noise in the causal system that affects said node. The set of
observed parents can be the empty set. When there are observed parents, the node’s value is the following
function:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[node = f(observed\_parents, exogenous\_parent)\]</div>
</div></blockquote>
<p>The causal diagram locally around <code class="docutils literal notranslate"><span class="pre">node</span></code> looks like <span class="math notranslate nohighlight">\(observed\_parents \rightarrow node \leftarrow exogenous\_parent\)</span>,
where <code class="docutils literal notranslate"><span class="pre">observed_parents</span></code> can be multiple sets of direct parents. In general, this can be arbitrarily complex,
since the function <code class="docutils literal notranslate"><span class="pre">f</span></code> can mean anything. In our simulations, we assume additive noise,
so the node is a linear combination of possibly nonlinear functions.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[node = f(observed\_parents) + g(exogenous\_parent)\]</div>
</div></blockquote>
<p>In order to represent this function, we imbue each node with a set of node attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parent_function</span></code>: This computes <span class="math notranslate nohighlight">\(f(observed\_parents)\)</span> for any node.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exogenous_function</span></code>: This computes <span class="math notranslate nohighlight">\(g(exogenous\_parent)\)</span> for any node.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exogenous_distribution</span></code>: This is the distribution of the exogenous variable for any node.</p></li>
</ul>
<p>Then the node value is a deterministically computed. If there are no parents, then
the node attribute will contain <code class="docutils literal notranslate"><span class="pre">None</span></code>. This enables stochasticity in the data-generating
process due to the inherent randomness that we can attach to the distribution of <code class="docutils literal notranslate"><span class="pre">exogenous_function</span></code>.
Due to the multivariate input nature of <code class="docutils literal notranslate"><span class="pre">parent_function</span></code>, it must be a Callable that takes
(keyword) arguments of the observed parents and returns a single value. Due to the univariate input
nature of <code class="docutils literal notranslate"><span class="pre">exogenous_function</span></code>, it must be a Callable that takes a single value and
returns a single value.</p>
<p><strong>Ordering of parent function arguments</strong></p>
<p>It is presumed that the <code class="docutils literal notranslate"><span class="pre">parent_function</span></code> is a function of the observed parents in the sorted order
that they are specified in the <code class="docutils literal notranslate"><span class="pre">G.predecessors(node)</span></code> list. For example, if the node <code class="docutils literal notranslate"><span class="pre">node</span></code> has
observed parents <code class="docutils literal notranslate"><span class="pre">[parent_1,</span> <span class="pre">parent_2]</span></code>, then the <code class="docutils literal notranslate"><span class="pre">parent_function</span></code> must be a function of
<code class="docutils literal notranslate"><span class="pre">parent_1</span></code> and <code class="docutils literal notranslate"><span class="pre">parent_2</span></code> in that order.</p>
<section id="multiple-distributions-interventions-and-domain-shifts">
<h3><span class="section-number">2.1.1. </span>Multiple Distributions: Interventions and Domain Shifts<a class="headerlink" href="#multiple-distributions-interventions-and-domain-shifts" title="Link to this heading">#</a></h3>
<p>Next, we discuss how to represent multiple distributions in a single graph. In the context of causal inference,
there are two graphical representations that allow for a general treatment of multiple distributions:
the augmented causal diagram <a class="footnote-reference brackets" href="#footcite-dawid2002influencediagrams" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> and the selection diagram <a class="footnote-reference brackets" href="#footcite-bareinboim-causal-2016" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.
The augmented causal diagram is a graph that augments the original causal diagram with a set of
F-nodes that represent interventions. The selection
diagram is a graph that augments the original causal diagram with a set of S-nodes that represent
domain shifts. In both cases, the augmented graph is acyclic. They can also be combined to simultaneously
represent interventions and domain shifts.</p>
<p>To represent both types of distribution changes in the same graph, we note that S-nodes explicitly
either change the type of function that is used to compute the node value, or changes the distribution
of the exogenous parent variable. In the case of interventions, the function <span class="math notranslate nohighlight">\(f\)</span> is changed
only.</p>
<p><strong>Interventional distribution change:</strong></p>
<p>In the interventional case, each F-node then points to any number of observed nodes in the graph.</p>
<p>Each observed variable node that a F-node points to has a node attribute <code class="docutils literal notranslate"><span class="pre">intervention_functions</span></code>
that maps each of its parent F-nodes to a possibly new function that is used to compute
<span class="math notranslate nohighlight">\(f'(observed\_parents)\)</span>.</p>
<p><strong>Domain change distribution change:</strong></p>
<p>In the domain shift case, each S-node has a node attribute <code class="docutils literal notranslate"><span class="pre">domains</span></code> that is a
unique tuple of domain integers, indicating the pair of domains that are being shifted between.
Then each node that the S-node points to has a node attribute <code class="docutils literal notranslate"><span class="pre">domain_parent_functions</span></code> that
maps each domain ID to a possibly new function that is used to compute <span class="math notranslate nohighlight">\(f'(observed\_parents)\)</span>.
In addition, each node that the S-node points to has a node attribute <code class="docutils literal notranslate"><span class="pre">domain_exogenous_distribution</span></code>
that maps each domain to a possibly new function that is used to compute <span class="math notranslate nohighlight">\(g'(exogenous\_parent)\)</span>.</p>
<p>Note to sample from multiple domain changes, we always set the smallest domain ID to be the reference
distribution. For example, if domain IDs are <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">4,</span> <span class="pre">5)</span></code>, then the reference domain is domain <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</section>
<section id="sampling-from-the-graph">
<h3><span class="section-number">2.1.2. </span>Sampling from the graph<a class="headerlink" href="#sampling-from-the-graph" title="Link to this heading">#</a></h3>
<p>Now, we have discussed how we generally represent the functional relationships of each node in the graph.
We now discuss how to sample from the graph. We first sample from the exogenous parent variable of
every observed node in the graph, which may be a function of the domain ID if the domain ID is defined.
Then, we sample the observed variables in topological order as a function of their exogenous variables
and their causal parents. The distribution sampled here is always the observational distribution of the
first domain (e.g. domain 1 out of N domains).</p>
<p>Given, a functional graph with multiple distributions (e.g. through interventions, or S-nodes), we
can sample the additional distributions by sampling the observed nodes in topological order again.
Consider sampling from a different domain. Each node that is a child of a S-node for the domain
that we are considering is sampled from the following distribution:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[node = f'(observed\_parents) + g'(exogenous\_parent)\]</div>
</div></blockquote>
<p>where f’ and g’ are new functions that are encoded in the node’s <code class="docutils literal notranslate"><span class="pre">domain_parent_functions</span></code>
and <code class="docutils literal notranslate"><span class="pre">domain_exogenous_distribution</span></code> dictionaries. These uniquely define the new distribution
as a result of the domain shift.</p>
<p>Similarly, sampling from interventional distributions will consider each child of an F-node
for the intervention and domain that we are considering (i.e. the input should specify the
domain ID and the intervention setting we want to sample). Then we similarly sample the relevant
<code class="docutils literal notranslate"><span class="pre">domain_exogenous_distribution</span></code> and <code class="docutils literal notranslate"><span class="pre">intervention_functions</span></code>. Note that <code class="docutils literal notranslate"><span class="pre">domain_parent_functions</span></code>
are not used in the interventional case, since the interventions take precedence over the domain
shift in terms of altering the functional relationship with respect to observed variables. However,
we implicitly assume the exogenous distribution is unalterable by the intervention.</p>
</section>
<section id="limitations">
<h3><span class="section-number">2.1.3. </span>Limitations<a class="headerlink" href="#limitations" title="Link to this heading">#</a></h3>
<p>It is important to explicitly note some limitations of generating data with this API.</p>
<ol class="arabic simple">
<li><p>The graph must be well-defined: The graph must be acyclic and already be defined
with a structure, before adding functional relationships.</p></li>
<li><p>The graph currently may not contain latent confounders: We plan to add this functionality
in the future. But as of now, there is no way to represent the functional relationship
of <span class="math notranslate nohighlight">\(X \leftrightarrow Y\)</span>.</p></li>
<li><p>Additive noise: Currently, we only support additive noise. We plan to add multiplicative
noise in the future.</p></li>
<li><p>Univariate input/output: We do not explore the possibility of a multivariate input/output
distribution. For example, if <span class="math notranslate nohighlight">\(X \in \mathbb{R}^d\)</span> and a parent of X is <span class="math notranslate nohighlight">\(Y \in \mathbb{R}^m\)</span>,
where Y is m-dimensional and X is d-dimensional and <code class="docutils literal notranslate"><span class="pre">f</span></code> is a function mapping Y to X, then
this is not supported.</p></li>
<li><p>Randomness: Users cannot pass in a random state, or RNG directly to the <code class="docutils literal notranslate"><span class="pre">sample_from_graph</span></code> function,
but rather must instantiate any random functions with the RNG during construction of the functional graph.</p></li>
</ol>
</section>
</section>
<section id="specific-functional-graphs">
<h2><span class="section-number">2.2. </span>Specific Functional Graphs<a class="headerlink" href="#specific-functional-graphs" title="Link to this heading">#</a></h2>
<p>In this section, we discuss how to represent specific functional graphs with the API and some of their
intricacies given the assumptions of the API discussed above.</p>
<section id="discrete-functional-graphs">
<h3><span class="section-number">2.2.1. </span>Discrete functional graphs<a class="headerlink" href="#discrete-functional-graphs" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/pywhy_graphs.functional.discrete.make_random_discrete_graph.html#pywhy_graphs.functional.discrete.make_random_discrete_graph" title="pywhy_graphs.functional.discrete.make_random_discrete_graph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_random_discrete_graph</span></code></a>(G[, ...])</p></td>
<td><p>Sample a random discrete graph given a graph structure.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/pywhy_graphs.functional.discrete.add_cpd_for_node.html#pywhy_graphs.functional.discrete.add_cpd_for_node" title="pywhy_graphs.functional.discrete.add_cpd_for_node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_cpd_for_node</span></code></a>(G, node, cpd[, ...])</p></td>
<td><p>Add CPD (Conditional Probability Distribution) to graph.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Discrete graphs can be fully represented by conditional probability tables (CPTs). Here, it is assumed
each observed variable is discrete and the full set of possible values are known apriori. Hence,
for each observed node, one can construct a table of their possible output values against the
combination of different parent discrete values. Within each entry of the table, there is a probability
value associated. This then gives us a model for <span class="math notranslate nohighlight">\(P(X = x| Pa_X)\)</span> for each value of <code class="docutils literal notranslate"><span class="pre">X=x</span></code> and
possible value of <code class="docutils literal notranslate"><span class="pre">Pa_X</span></code>.</p>
<p>Therefore, each node in the graph has a node attribute <code class="docutils literal notranslate"><span class="pre">cpt</span></code>, which is associated with a
<a class="reference external" href="https://pgmpy.org/factors/discrete.html#pgmpy.factors.discrete.CPD.TabularCPD" title="(in pgmpy vdev branch)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pgmpy.factors.discrete.CPD.TabularCPD</span></code></a>. We leverage <code class="docutils literal notranslate"><span class="pre">pgmpy</span></code> to represent CPTs and wrap an API around that.
Given each CPT, the <code class="docutils literal notranslate"><span class="pre">parent_function</span></code> is fully defined as just a discrete distribution sampling
with possibly non-uniform probabilities.</p>
<p>In order to represent a noisy discrete function, we define <code class="docutils literal notranslate"><span class="pre">exogenous_function</span></code> as the uniform
discrete distribution over all possible values of the node. Then, we add a hyperparameter <code class="docutils literal notranslate"><span class="pre">noise_ratio</span></code>
which is a value between 0.0 and 1.0, which defines the probability one uses the <code class="docutils literal notranslate"><span class="pre">exogenous_function</span></code>
to sample the values of node. If one does not use the <code class="docutils literal notranslate"><span class="pre">exogenous_function</span></code> to sample the node,
then the <code class="docutils literal notranslate"><span class="pre">parent_function</span></code> is used. The default value of <code class="docutils literal notranslate"><span class="pre">noise_ratio</span></code> is 0.</p>
<p>Adding interventions and multiple-domains is simple as the <code class="docutils literal notranslate"><span class="pre">parent_function</span></code> is overridden by their respective
functions. We can view these different distributions as simply having a different CPT.</p>
</section>
</section>
<section id="linear">
<h2><span class="section-number">2.3. </span>Linear<a class="headerlink" href="#linear" title="Link to this heading">#</a></h2>
<p>In order to represent linear functions, we imbue nodes with a set of node attributes:</p>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">parent_functions</span></code>: a mapping of functions that map each node to a nested dictionary</dt><dd><p>of parents and their corresponding weight and function that map parent values to
values that are input to the node value with the weight.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">gaussian_noise_function</span></code>: a dictionary with keys <code class="docutils literal notranslate"><span class="pre">mean</span></code> and <code class="docutils literal notranslate"><span class="pre">std</span></code> that</dt><dd><p>encodes the data-generating function for the Gaussian noise.</p>
<p>For example, if the node
is <span class="math notranslate nohighlight">\(X\)</span> and its parents are <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(Z\)</span>, then <code class="docutils literal notranslate"><span class="pre">parent_functions</span></code>
and <code class="docutils literal notranslate"><span class="pre">gaussian_noise_function</span></code> for node <span class="math notranslate nohighlight">\(X\)</span> is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;parent_functions&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">weight</span> <span class="n">of</span> <span class="n">Y</span> <span class="n">added</span> <span class="n">to</span> <span class="n">X</span><span class="o">&gt;</span><span class="p">,</span>
                <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">that</span> <span class="n">takes</span> <span class="nb">input</span> <span class="n">Y</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">weight</span> <span class="n">of</span> <span class="n">Z</span> <span class="n">added</span> <span class="n">to</span> <span class="n">X</span><span class="o">&gt;</span><span class="p">,</span>
                <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">that</span> <span class="n">takes</span> <span class="nb">input</span> <span class="n">Z</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="s1">&#39;gaussian_noise_function&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">mean</span> <span class="n">of</span> <span class="n">gaussian</span> <span class="n">noise</span> <span class="n">added</span> <span class="n">to</span> <span class="n">X</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">std</span> <span class="n">of</span> <span class="n">gaussian</span> <span class="n">noise</span> <span class="n">added</span> <span class="n">to</span> <span class="n">X</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</section>
<section id="id4">
<h2><span class="section-number">2.4. </span>Linear<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>In order to represent linear functions, we imbue nodes with a set of node attributes:</p>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">parent_functions</span></code>: a mapping of functions that map each node to a nested dictionary</dt><dd><p>of parents and their corresponding weight and function that map parent values to
values that are input to the node value with the weight.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">gaussian_noise_function</span></code>: a dictionary with keys <code class="docutils literal notranslate"><span class="pre">mean</span></code> and <code class="docutils literal notranslate"><span class="pre">std</span></code> that</dt><dd><p>encodes the data-generating function for the Gaussian noise.</p>
<p>For example, if the node
is <span class="math notranslate nohighlight">\(X\)</span> and its parents are <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(Z\)</span>, then <code class="docutils literal notranslate"><span class="pre">parent_functions</span></code>
and <code class="docutils literal notranslate"><span class="pre">gaussian_noise_function</span></code> for node <span class="math notranslate nohighlight">\(X\)</span> is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;parent_functions&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">weight</span> <span class="n">of</span> <span class="n">Y</span> <span class="n">added</span> <span class="n">to</span> <span class="n">X</span><span class="o">&gt;</span><span class="p">,</span>
                <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">that</span> <span class="n">takes</span> <span class="nb">input</span> <span class="n">Y</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">weight</span> <span class="n">of</span> <span class="n">Z</span> <span class="n">added</span> <span class="n">to</span> <span class="n">X</span><span class="o">&gt;</span><span class="p">,</span>
                <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">that</span> <span class="n">takes</span> <span class="nb">input</span> <span class="n">Z</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="s1">&#39;gaussian_noise_function&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">mean</span> <span class="n">of</span> <span class="n">gaussian</span> <span class="n">noise</span> <span class="n">added</span> <span class="n">to</span> <span class="n">X</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">std</span> <span class="n">of</span> <span class="n">gaussian</span> <span class="n">noise</span> <span class="n">added</span> <span class="n">to</span> <span class="n">X</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</section>
<section id="linear-functional-graphs">
<h2><span class="section-number">2.5. </span>Linear functional graphs<a class="headerlink" href="#linear-functional-graphs" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/pywhy_graphs.functional.make_graph_linear_gaussian.html#pywhy_graphs.functional.make_graph_linear_gaussian" title="pywhy_graphs.functional.make_graph_linear_gaussian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_graph_linear_gaussian</span></code></a>(G[, ...])</p></td>
<td><p>Convert an existing DAG to a linear Gaussian graphical model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../generated/pywhy_graphs.functional.apply_linear_soft_intervention.html#pywhy_graphs.functional.apply_linear_soft_intervention" title="pywhy_graphs.functional.apply_linear_soft_intervention"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_linear_soft_intervention</span></code></a>(G, targets[, ...])</p></td>
<td><p>Applies a soft intervention to a linear Gaussian graph.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="multidomain">
<h2><span class="section-number">2.6. </span>Multidomain<a class="headerlink" href="#multidomain" title="Link to this heading">#</a></h2>
<p>Currently, this submodule only supports linear functions.</p>
<p>Multiple-domain causal graphs are represented by selection diagrams <a class="footnote-reference brackets" href="#footcite-bareinboim-causal-2016" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>,
or augmented selection diagrams (TODO: CITATION FOR LEARNING SEL DIAGRAMS).</p>
<p>In order to represent multidomain functions, we imbue nodes with a set of node attributes
in addition to the ones for linear functions. The nodes that are imbued with extra attributes
are the direct children of an S-node.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">invariant_domains</span></code>: a list of domain IDs that are invariant for this node.</p></li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">domain_gaussian_noise_function</span></code>: a dictionary with keys <code class="docutils literal notranslate"><span class="pre">mean</span></code> and <code class="docutils literal notranslate"><span class="pre">std</span></code> that</dt><dd><p>encodes the data-generating function for the Gaussian noise for each non-invariant domain.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;domain_gaussian_noise_function&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="o">&lt;</span><span class="n">domain_id</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">mean</span> <span class="n">of</span> <span class="n">gaussian</span> <span class="n">noise</span> <span class="n">added</span> <span class="n">to</span> <span class="n">X</span><span class="o">&gt;</span><span class="p">,</span>
                <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">std</span> <span class="n">of</span> <span class="n">gaussian</span> <span class="n">noise</span> <span class="n">added</span> <span class="n">to</span> <span class="n">X</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="s1">&#39;invariant_domains&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">domain_id</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</section>
<section id="linear-functional-selection-diagrams">
<h2><span class="section-number">2.7. </span>Linear functional selection diagrams<a class="headerlink" href="#linear-functional-selection-diagrams" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../generated/pywhy_graphs.functional.make_graph_multidomain.html#pywhy_graphs.functional.make_graph_multidomain" title="pywhy_graphs.functional.make_graph_multidomain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_graph_multidomain</span></code></a>(G[, n_domains, ...])</p></td>
<td><p>Convert an existing linear Gaussian DAG to a multi-domain selection diagram model.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../classes/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Causal Graphs in PyWhy</p>
      </div>
    </a>
    <a class="right-next"
       href="../../generated/pywhy_graphs.functional.discrete.make_random_discrete_graph.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.2.1.1. </span>pywhy_graphs.functional.discrete.make_random_discrete_graph</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#representing-a-node-s-functional-relationships">2.1. Representing a node’s functional relationships</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-distributions-interventions-and-domain-shifts">2.1.1. Multiple Distributions: Interventions and Domain Shifts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-from-the-graph">2.1.2. Sampling from the graph</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations">2.1.3. Limitations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specific-functional-graphs">2.2. Specific Functional Graphs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discrete-functional-graphs">2.2.1. Discrete functional graphs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear">2.3. Linear</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.4. Linear</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-functional-graphs">2.5. Linear functional graphs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multidomain">2.6. Multidomain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-functional-selection-diagrams">2.7. Linear functional selection diagrams</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/reference/functional/index.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Adam Li.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>